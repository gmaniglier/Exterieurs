drop view if exists v_nbvalid;
create view v_nbvalid as select count(Id_unique) as nbvalid from outsiders where datefin >= curdate();

drop view if exists v_nboutdated;
create view v_nboutdated as select count(Id_unique) as nboutdated from outsiders where datefin < curdate();

drop view if exists v_stats;
create view v_stats as select a.nbvalid, b.nboutdated from v_nbvalid a, v_nboutdated b;

drop view if exists v_export;
create view v_export as select  Id_unique as ID_INDIVIDU, 
                                Civ as CIVILITE, 
                                Nom as NOM_USUEL, 
                                Nom as NOM_PATRONYMIQUE,
                                Prenom as PRENOM,
                                '1900-01-01' as DATE_NAISSANCE,
                                '' as INE,
                                '0311256X' as RNE_ETABLISSEMENT,
                                '0311256X' as REN_COMPOSANTE,
                                '' as CODE_GESTION,
                                '' as CODE_TARIF1,
                                '' as CODE_CATEGORIE1,
                                 '' as CODE_TARIF2,
                                '' as CODE_CATEGORIE2,
                                 '' as CODE_TARIF3,
                                '' as CODE_CATEGORIE3,
                                 '' as CODE_TARIF4,
                                '' as CODE_CATEGORIE4,
                                 '' as CODE_TARIF5,
                                '' as CODE_CATEGORIE5,
                                 '' as CODE_TARIF6,
                                '' as CODE_CATEGORIE6,
                                 '' as CODE_TARIF7,
                                '' as CODE_CATEGORIE7,
                                 '' as CODE_TARIF8,
                                '' as CODE_CATEGORIE8,
                                 '' as CODE_TARIF9,
                                '' as CODE_CATEGORIE9,
                                 '' as CODE_TARIF10,
                                '' as CODE_CATEGORIE10,
                                 '' as CODE_TARIF11,
                                '' as CODE_CATEGORIE11,
                                 '' as CODE_TARIF12,
                                '' as CODE_CATEGORIE12,
                                '31' as CATEGORIE_CROUS,
                                datedebut as DATE_DEBUT_VALIDITE,
                                datefin as DATE_FIN_VALIDITE,
                                'O' as DROIT_PHOTO,
                                'O' as DROIT_IMPORT,
                                'EXTERIEUR' as VISUEL_CARTE_TYPE,
                                '' as VISUEL_CARTE_MINISTERE,
                                '1201' as VISUEL_LOGO,
                                Societe as VISUEL_CARTE_COMPLEMENT,
                                '' as COMMENTAIRE,
                                '' as E_MAIL,
                                '' as CODE_NATIONALITE,
                                '' as ADRESSE1,
                                '' as ADRESSE2,
                                '' as ADRESSE3,
                                '' as CODE_POSTAL,
                                '' as VILLE,
                                '' as CODE_PAYS,
                                '' as AUTRE_ADRESSE1,
                                '' as AUTRE_ADRESSE2,
                                '' as AUTRE_ADRESSE3,
                                '' as AUTRE_CODE_POSTAL,
                                '' as AUTRE_VILLE,
                                '' as AUTRE_CODE_PAYS,
                                '' as TELEPHONE1,
                                '' as TELEPHONE2,
                                Societe as STRUCTURE,
                                '' as NIVEAU,
                                '' as CODE_SISE_FORMATION,
                                '' as CODE_ETAPE,
                                '' as FORMATION,
                                '' as ECHANGE_INTERNATIONAUX,
                                '' as SENS_ECHANGE,
                                datedebut as DATE_INSCRIPTION,
                                YEAR(datedebut) as ANNEE_UNIVERSITAIRE,
                                '' as CODE_TITULAIRE,
                                '' as TYPE_POPULATION,
                                '' as TYPE_CONTRAT,
                                '' as SPECIFIQUE1,
                                '' as SPECIFIQUE2,
                                '' as SPECIFIQUE3,
                                '' as SPECIFIQUE4,
                                '' as SPECIFIQUE5,
                                Societe as SPECIFIQUE6,
                                '' as SPECIFIQUE7,
                                '' as SPECIFIQUE8,
                                '' as SPECIFIQUE9,
                                '' as SPECIFIQUE10,
                                'MifareDESFIRE EV1' as TECHNO_CARTE,
                                '' as ETAPES,
                                '' as PERIODE_RETENTION,
                                '' as DELAI_INVALIDATION
                                                          
                                from outsiders
                                where datefin > DATE(NOW());
                                
 

